# Load Testing with k6

[k6](https://k6.io/) is a modern, open-source load testing tool designed for developer ergonomics. It uses scripts written in JavaScript to define test scenarios, making it easy to integrate into development workflows.

This document provides a generic example of how to use k6 to generate load for testing auto-scaling policies.

## Why k6?

- **Developer-Friendly:** Tests are written in JavaScript (ES2015/ES6), which is familiar to many developers.
- **High Performance:** k6 is written in Go and is highly performant, capable of generating significant load from a single machine.
- **Goal-Oriented:** k6 focuses on goal-oriented testing with its concept of "Thresholds," which allows you to define pass/fail criteria for your tests (e.g., "99% of requests must complete in under 300ms").

## Example Load Test Script

This script, which can be named `test.js`, simulates a gradual ramp-up of virtual users (VUs) accessing a target URL. This is useful for testing how an auto-scaler reacts to a steady increase in traffic.

```javascript
import http from 'k6/http';
import { sleep } from 'k6';

// The target URL for the load test.
// Make sure to replace this with the actual URL of your service.
const TARGET_URL = 'http://<your-service-url>';

export const options = {
  // The 'stages' array defines the load profile.
  stages: [
    // Ramp up to 100 virtual users over 30 seconds
    { duration: '30s', target: 100 },
    // Stay at 100 virtual users for 1 minute
    { duration: '1m', target: 100 },
    // Ramp up to 500 virtual users over 30 seconds
    { duration: '30s', target: 500 },
    // Stay at 500 virtual users for 2 minutes
    { duration: '2m', target: 500 },
    // Ramp down to 0 users over 30 seconds
    { duration: '30s', target: 0 },
  ],
  // Define pass/fail criteria for the test.
  thresholds: {
    'http_req_duration': ['p(95)<500'], // 95% of requests must complete below 500ms
    'http_req_failed': ['rate<0.01'],   // http errors should be less than 1%
  },
};

// The main function that defines the behavior of a single virtual user.
export default function () {
  // Send a GET request to the target URL.
  http.get(TARGET_URL);
  // Wait for 1 second before the next request.
  sleep(1);
}
```

## How to Run the Test

1.  **Install k6:** Follow the [official installation instructions](https://k6.io/docs/getting-started/installation/).
2.  **Save the script:** Save the code above as `test.js`.
3.  **Run from the command line:**
    ```bash
    k6 run test.js
    ```

While this test is running, you should monitor your auto-scaling dashboard to observe how the system responds to the generated load.
